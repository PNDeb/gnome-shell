From: =?utf-8?b?Ik1hcmNvIFRyZXZpc2FuIChUcmV2acOxbyki?= <mail@3v1n0.net>
Date: Wed, 1 May 2024 04:22:29 +0200
Subject: tray: Zero-initialize the event structures on initialization

Origin: https://gitlab.gnome.org/3v1n0/gnome-shell/-/commits/tray-offscreen-xwindows
Bug-Ubuntu: https://bugs.launchpad.net/bugs/2012388
---
 src/tray/na-tray-child.c | 6 +++---
 src/tray/na-xembed.c     | 6 ++----
 2 files changed, 5 insertions(+), 7 deletions(-)

diff --git a/src/tray/na-tray-child.c b/src/tray/na-tray-child.c
index 0911995..9ec6670 100644
--- a/src/tray/na-tray-child.c
+++ b/src/tray/na-tray-child.c
@@ -260,9 +260,9 @@ na_tray_child_emulate_event (NaTrayChild *tray_child,
                              ClutterEvent *event)
 {
   MetaX11Display *x11_display;
-  XKeyEvent xkevent;
-  XButtonEvent xbevent;
-  XCrossingEvent xcevent;
+  XKeyEvent xkevent = {0};
+  XButtonEvent xbevent = {0};
+  XCrossingEvent xcevent = {0};
   Display *xdisplay;
   Window xwindow, xrootwindow;
   ClutterEventType event_type = clutter_event_type (event);
diff --git a/src/tray/na-xembed.c b/src/tray/na-xembed.c
index be08d6d..398669c 100644
--- a/src/tray/na-xembed.c
+++ b/src/tray/na-xembed.c
@@ -115,9 +115,8 @@ xembed_send_message (NaXembed          *xembed,
 {
   NaXembedPrivate *priv = na_xembed_get_instance_private (xembed);
   Display *xdisplay = meta_x11_display_get_xdisplay (priv->x11_display);
-  XClientMessageEvent xclient;
+  XClientMessageEvent xclient = {0};
 
-  memset (&xclient, 0, sizeof (xclient));
   xclient.window = recipient;
   xclient.type = ClientMessage;
   xclient.message_type = priv->atom__XEMBED;
@@ -153,10 +152,9 @@ static void
 na_xembed_send_configure_event (NaXembed *xembed)
 {
   NaXembedPrivate *priv = na_xembed_get_instance_private (xembed);
-  XConfigureEvent xconfigure;
+  XConfigureEvent xconfigure = {0};
   Display *xdisplay = meta_x11_display_get_xdisplay (priv->x11_display);
 
-  memset (&xconfigure, 0, sizeof (xconfigure));
   xconfigure.type = ConfigureNotify;
 
   xconfigure.event = priv->plug_window;
