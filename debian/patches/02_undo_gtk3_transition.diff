Index: gnome-shell-2.31.5/configure
===================================================================
--- gnome-shell-2.31.5.orig/configure	2010-07-13 15:36:27.864606260 -0300
+++ gnome-shell-2.31.5/configure	2010-07-13 15:43:52.512105705 -0300
@@ -797,6 +797,8 @@
 GCONF_SCHEMA_FILE_DIR
 GCONF_SCHEMA_CONFIG_SOURCE
 GCONFTOOL
+PKG_CONFIG_LIBDIR
+PKG_CONFIG_PATH
 PKG_CONFIG
 MKINSTALLDIRS
 POSUB
@@ -980,6 +982,8 @@
 CPPFLAGS
 CPP
 PKG_CONFIG
+PKG_CONFIG_PATH
+PKG_CONFIG_LIBDIR
 TEST_SHELL_RECORDER_CFLAGS
 TEST_SHELL_RECORDER_LIBS
 MUTTER_PLUGIN_CFLAGS
@@ -1652,6 +1656,10 @@
               you have headers in a nonstandard directory <include dir>
   CPP         C preprocessor
   PKG_CONFIG  path to pkg-config utility
+  PKG_CONFIG_PATH
+              directories to add to pkg-config's search path
+  PKG_CONFIG_LIBDIR
+              path overriding pkg-config's built-in search path
   TEST_SHELL_RECORDER_CFLAGS
               C compiler flags for TEST_SHELL_RECORDER, overriding pkg-config
   TEST_SHELL_RECORDER_LIBS
@@ -4790,13 +4798,13 @@
 else
   lt_cv_nm_interface="BSD nm"
   echo "int some_variable = 0;" > conftest.$ac_ext
-  (eval echo "\"\$as_me:4793: $ac_compile\"" >&5)
+  (eval echo "\"\$as_me:4801: $ac_compile\"" >&5)
   (eval "$ac_compile" 2>conftest.err)
   cat conftest.err >&5
-  (eval echo "\"\$as_me:4796: $NM \\\"conftest.$ac_objext\\\"\"" >&5)
+  (eval echo "\"\$as_me:4804: $NM \\\"conftest.$ac_objext\\\"\"" >&5)
   (eval "$NM \"conftest.$ac_objext\"" 2>conftest.err > conftest.out)
   cat conftest.err >&5
-  (eval echo "\"\$as_me:4799: output\"" >&5)
+  (eval echo "\"\$as_me:4807: output\"" >&5)
   cat conftest.out >&5
   if $GREP 'External.*some_variable' conftest.out > /dev/null; then
     lt_cv_nm_interface="MS dumpbin"
@@ -5262,11 +5270,11 @@
   ;;
 
 # This must be Linux ELF.
-linux* | k*bsd*-gnu)
+linux* | k*bsd*-gnu | kopensolaris*-gnu)
   lt_cv_deplibs_check_method=pass_all
   ;;
 
-netbsd*)
+netbsd* | netbsdelf*-gnu)
   if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
   else
@@ -6002,7 +6010,7 @@
   ;;
 *-*-irix6*)
   # Find out which ABI we are using.
-  echo '#line 6005 "configure"' > conftest.$ac_ext
+  echo '#line 6013 "configure"' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
   (eval $ac_compile) 2>&5
   ac_status=$?
@@ -7531,11 +7539,11 @@
    -e 's:.*FLAGS}\{0,1\} :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:7534: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:7542: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>conftest.err)
    ac_status=$?
    cat conftest.err >&5
-   echo "$as_me:7538: \$? = $ac_status" >&5
+   echo "$as_me:7546: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
@@ -7700,7 +7708,7 @@
       lt_prog_compiler_static='-non_shared'
       ;;
 
-    linux* | k*bsd*-gnu)
+    linux* | k*bsd*-gnu | kopensolaris*-gnu)
       case $cc_basename in
       # old Intel for x86_64 which still supported -KPIC.
       ecc*)
@@ -7870,11 +7878,11 @@
    -e 's:.*FLAGS}\{0,1\} :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:7873: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:7881: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>conftest.err)
    ac_status=$?
    cat conftest.err >&5
-   echo "$as_me:7877: \$? = $ac_status" >&5
+   echo "$as_me:7885: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
@@ -7975,11 +7983,11 @@
    -e 's:.*FLAGS}\{0,1\} :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:7978: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:7986: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>out/conftest.err)
    ac_status=$?
    cat out/conftest.err >&5
-   echo "$as_me:7982: \$? = $ac_status" >&5
+   echo "$as_me:7990: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
    then
      # The compiler can only warn and ignore the option if not recognized
@@ -8030,11 +8038,11 @@
    -e 's:.*FLAGS}\{0,1\} :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:8033: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:8041: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>out/conftest.err)
    ac_status=$?
    cat out/conftest.err >&5
-   echo "$as_me:8037: \$? = $ac_status" >&5
+   echo "$as_me:8045: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
    then
      # The compiler can only warn and ignore the option if not recognized
@@ -8149,6 +8157,9 @@
   openbsd*)
     with_gnu_ld=no
     ;;
+  linux* | k*bsd*-gnu)
+    link_all_deplibs=no
+    ;;
   esac
 
   ld_shlibs=yes
@@ -8170,6 +8181,7 @@
     fi
     supports_anon_versioning=no
     case `$LD -v 2>&1` in
+      *GNU\ gold*) supports_anon_versioning=yes ;;
       *\ [01].* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions < 2.11
       *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
       *\ 2.11.92.0.12\ *) supports_anon_versioning=yes ;; # Mandrake 8.2 ...
@@ -8261,7 +8273,7 @@
       archive_expsym_cmds='sed "s,^,_," $export_symbols >$output_objdir/$soname.expsym~$CC -shared $pic_flag $libobjs $deplibs $compiler_flags ${wl}-h,$soname ${wl}--retain-symbols-file,$output_objdir/$soname.expsym ${wl}--image-base,`expr ${RANDOM-$$} % 4096 / 2 \* 262144 + 1342177280` -o $lib'
       ;;
 
-    gnu* | linux* | tpf* | k*bsd*-gnu)
+    gnu* | linux* | tpf* | k*bsd*-gnu | kopensolaris*-gnu)
       tmp_diet=no
       if test "$host_os" = linux-dietlibc; then
 	case $cc_basename in
@@ -8331,7 +8343,7 @@
       fi
       ;;
 
-    netbsd*)
+    netbsd* | netbsdelf*-gnu)
       if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable $libobjs $deplibs $linker_flags -o $lib'
 	wlarc=
@@ -8506,6 +8518,7 @@
 	if test "$aix_use_runtimelinking" = yes; then
 	  shared_flag="$shared_flag "'${wl}-G'
 	fi
+	link_all_deplibs=no
       else
 	# not using gcc
 	if test "$host_cpu" = ia64; then
@@ -8832,7 +8845,7 @@
       link_all_deplibs=yes
       ;;
 
-    netbsd*)
+    netbsd* | netbsdelf*-gnu)
       if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'  # a.out
       else
@@ -9722,7 +9735,7 @@
   ;;
 
 # This must be Linux ELF.
-linux* | k*bsd*-gnu)
+linux* | k*bsd*-gnu | kopensolaris*-gnu)
   version_type=linux
   need_lib_prefix=no
   need_version=no
@@ -9762,13 +9775,10 @@
   # before this can be enabled.
   hardcode_into_libs=yes
 
-  # Add ABI-specific directories to the system library path.
-  sys_lib_dlsearch_path_spec="/lib64 /usr/lib64 /lib /usr/lib"
-
   # Append ld.so.conf contents to the search path
   if test -f /etc/ld.so.conf; then
     lt_ld_extra=`awk '/^include / { system(sprintf("cd /etc; cat %s 2>/dev/null", \$2)); skip = 1; } { if (!skip) print \$0; skip = 0; }' < /etc/ld.so.conf | $SED -e 's/#.*//;/^[	 ]*hwcap[	 ]/d;s/[:,	]/ /g;s/=[^=]*$//;s/=[^= ]* / /g;/^$/d' | tr '\n' ' '`
-    sys_lib_dlsearch_path_spec="$sys_lib_dlsearch_path_spec $lt_ld_extra"
+    sys_lib_dlsearch_path_spec="/lib /usr/lib $lt_ld_extra"
   fi
 
   # We used to test for /lib/ld.so.1 and disable shared libraries on
@@ -9780,6 +9790,18 @@
   dynamic_linker='GNU/Linux ld.so'
   ;;
 
+netbsdelf*-gnu)
+  version_type=linux
+  need_lib_prefix=no
+  need_version=no
+  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major ${libname}${shared_ext}'
+  soname_spec='${libname}${release}${shared_ext}$major'
+  shlibpath_var=LD_LIBRARY_PATH
+  shlibpath_overrides_runpath=no
+  hardcode_into_libs=yes
+  dynamic_linker='NetBSD ld.elf_so'
+  ;;
+
 netbsd*)
   version_type=sunos
   need_lib_prefix=no
@@ -10400,7 +10422,7 @@
   lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2
   lt_status=$lt_dlunknown
   cat > conftest.$ac_ext <<_LT_EOF
-#line 10403 "configure"
+#line 10425 "configure"
 #include "confdefs.h"
 
 #if HAVE_DLFCN_H
@@ -10496,7 +10518,7 @@
   lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2
   lt_status=$lt_dlunknown
   cat > conftest.$ac_ext <<_LT_EOF
-#line 10499 "configure"
+#line 10521 "configure"
 #include "confdefs.h"
 
 #if HAVE_DLFCN_H
@@ -11996,6 +12018,10 @@
 
 
 
+
+
+
+
 if test "x$ac_cv_env_PKG_CONFIG_set" != "xset"; then
 	if test -n "$ac_tool_prefix"; then
   # Extract the first word of "${ac_tool_prefix}pkg-config", so it can be a program name with args.
@@ -12108,7 +12134,6 @@
 $as_echo "no" >&6; }
 		PKG_CONFIG=""
 	fi
-
 fi
 
 # GConf stuff
@@ -12218,6 +12243,10 @@
 
 
 
+
+
+
+
 if test "x$ac_cv_env_PKG_CONFIG_set" != "xset"; then
 	if test -n "$ac_tool_prefix"; then
   # Extract the first word of "${ac_tool_prefix}pkg-config", so it can be a program name with args.
@@ -12330,7 +12359,6 @@
 $as_echo "no" >&6; }
 		PKG_CONFIG=""
 	fi
-
 fi
   gsettingsschemadir=${datadir}/glib-2.0/schemas
 
@@ -12726,6 +12754,8 @@
 
 
 if test $pkg_failed = yes; then
+   	{ $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
+$as_echo "no" >&6; }
 
 if $PKG_CONFIG --atleast-pkgconfig-version 0.20; then
         _pkg_short_errors_supported=yes
@@ -12749,9 +12779,10 @@
 
 Alternatively, you may set the environment variables TEST_SHELL_RECORDER_CFLAGS
 and TEST_SHELL_RECORDER_LIBS to avoid the need to call pkg-config.
-See the pkg-config man page for more details.
-" "$LINENO" 5
+See the pkg-config man page for more details." "$LINENO" 5
 elif test $pkg_failed = untried; then
+     	{ $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
+$as_echo "no" >&6; }
 	{ { $as_echo "$as_me:${as_lineno-$LINENO}: error: in \`$ac_pwd':" >&5
 $as_echo "$as_me: error: in \`$ac_pwd':" >&2;}
 as_fn_error "The pkg-config script could not be found or is too old.  Make sure it
@@ -12769,7 +12800,7 @@
 	TEST_SHELL_RECORDER_LIBS=$pkg_cv_TEST_SHELL_RECORDER_LIBS
         { $as_echo "$as_me:${as_lineno-$LINENO}: result: yes" >&5
 $as_echo "yes" >&6; }
-	:
+
 fi
 else
    { $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
@@ -12789,7 +12820,7 @@
 GOBJECT_INTROSPECTION_MIN_VERSION=0.6.11
 GJS_MIN_VERSION=0.7
 MUTTER_MIN_VERSION=2.31.4
-GTK_MIN_VERSION=2.90.4
+GTK_MIN_VERSION=2.21.1
 GIO_MIN_VERSION=2.25.9
 
 # Collect more than 20 libraries for a prize!
@@ -12804,22 +12835,22 @@
     if test -n "$PKG_CONFIG" && \
     { { $as_echo "$as_me:${as_lineno-$LINENO}: \$PKG_CONFIG --exists --print-errors \"gio-2.0 >= \$GIO_MIN_VERSION
                                  gio-unix-2.0 dbus-glib-1
-                                 gtk+-3.0 >= \$GTK_MIN_VERSION
+                                 gtk+-2.0 >= \$GTK_MIN_VERSION
                                  mutter-plugins >= \$MUTTER_MIN_VERSION
                                  gjs-gi-1.0 >= \$GJS_MIN_VERSION
 				 libgnome-menu \$recorder_modules gconf-2.0
-                                 gdk-x11-3.0
+                                 gdk-x11-2.0
 				 clutter-x11-1.0 >= \$CLUTTER_MIN_VERSION
 				 clutter-glx-1.0 >= \$CLUTTER_MIN_VERSION
                                  libstartup-notification-1.0
                                  gobject-introspection-1.0 >= \$GOBJECT_INTROSPECTION_MIN_VERSION\""; } >&5
   ($PKG_CONFIG --exists --print-errors "gio-2.0 >= $GIO_MIN_VERSION
                                  gio-unix-2.0 dbus-glib-1
-                                 gtk+-3.0 >= $GTK_MIN_VERSION
+                                 gtk+-2.0 >= $GTK_MIN_VERSION
                                  mutter-plugins >= $MUTTER_MIN_VERSION
                                  gjs-gi-1.0 >= $GJS_MIN_VERSION
 				 libgnome-menu $recorder_modules gconf-2.0
-                                 gdk-x11-3.0
+                                 gdk-x11-2.0
 				 clutter-x11-1.0 >= $CLUTTER_MIN_VERSION
 				 clutter-glx-1.0 >= $CLUTTER_MIN_VERSION
                                  libstartup-notification-1.0
@@ -12829,11 +12860,11 @@
   test $ac_status = 0; }; then
   pkg_cv_MUTTER_PLUGIN_CFLAGS=`$PKG_CONFIG --cflags "gio-2.0 >= $GIO_MIN_VERSION
                                  gio-unix-2.0 dbus-glib-1
-                                 gtk+-3.0 >= $GTK_MIN_VERSION
+                                 gtk+-2.0 >= $GTK_MIN_VERSION
                                  mutter-plugins >= $MUTTER_MIN_VERSION
                                  gjs-gi-1.0 >= $GJS_MIN_VERSION
 				 libgnome-menu $recorder_modules gconf-2.0
-                                 gdk-x11-3.0
+                                 gdk-x11-2.0
 				 clutter-x11-1.0 >= $CLUTTER_MIN_VERSION
 				 clutter-glx-1.0 >= $CLUTTER_MIN_VERSION
                                  libstartup-notification-1.0
@@ -12850,22 +12881,22 @@
     if test -n "$PKG_CONFIG" && \
     { { $as_echo "$as_me:${as_lineno-$LINENO}: \$PKG_CONFIG --exists --print-errors \"gio-2.0 >= \$GIO_MIN_VERSION
                                  gio-unix-2.0 dbus-glib-1
-                                 gtk+-3.0 >= \$GTK_MIN_VERSION
+                                 gtk+-2.0 >= \$GTK_MIN_VERSION
                                  mutter-plugins >= \$MUTTER_MIN_VERSION
                                  gjs-gi-1.0 >= \$GJS_MIN_VERSION
 				 libgnome-menu \$recorder_modules gconf-2.0
-                                 gdk-x11-3.0
+                                 gdk-x11-2.0
 				 clutter-x11-1.0 >= \$CLUTTER_MIN_VERSION
 				 clutter-glx-1.0 >= \$CLUTTER_MIN_VERSION
                                  libstartup-notification-1.0
                                  gobject-introspection-1.0 >= \$GOBJECT_INTROSPECTION_MIN_VERSION\""; } >&5
   ($PKG_CONFIG --exists --print-errors "gio-2.0 >= $GIO_MIN_VERSION
                                  gio-unix-2.0 dbus-glib-1
-                                 gtk+-3.0 >= $GTK_MIN_VERSION
+                                 gtk+-2.0 >= $GTK_MIN_VERSION
                                  mutter-plugins >= $MUTTER_MIN_VERSION
                                  gjs-gi-1.0 >= $GJS_MIN_VERSION
 				 libgnome-menu $recorder_modules gconf-2.0
-                                 gdk-x11-3.0
+                                 gdk-x11-2.0
 				 clutter-x11-1.0 >= $CLUTTER_MIN_VERSION
 				 clutter-glx-1.0 >= $CLUTTER_MIN_VERSION
                                  libstartup-notification-1.0
@@ -12875,11 +12906,11 @@
   test $ac_status = 0; }; then
   pkg_cv_MUTTER_PLUGIN_LIBS=`$PKG_CONFIG --libs "gio-2.0 >= $GIO_MIN_VERSION
                                  gio-unix-2.0 dbus-glib-1
-                                 gtk+-3.0 >= $GTK_MIN_VERSION
+                                 gtk+-2.0 >= $GTK_MIN_VERSION
                                  mutter-plugins >= $MUTTER_MIN_VERSION
                                  gjs-gi-1.0 >= $GJS_MIN_VERSION
 				 libgnome-menu $recorder_modules gconf-2.0
-                                 gdk-x11-3.0
+                                 gdk-x11-2.0
 				 clutter-x11-1.0 >= $CLUTTER_MIN_VERSION
 				 clutter-glx-1.0 >= $CLUTTER_MIN_VERSION
                                  libstartup-notification-1.0
@@ -12894,6 +12925,8 @@
 
 
 if test $pkg_failed = yes; then
+   	{ $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
+$as_echo "no" >&6; }
 
 if $PKG_CONFIG --atleast-pkgconfig-version 0.20; then
         _pkg_short_errors_supported=yes
@@ -12903,11 +12936,11 @@
         if test $_pkg_short_errors_supported = yes; then
 	        MUTTER_PLUGIN_PKG_ERRORS=`$PKG_CONFIG --short-errors --print-errors "gio-2.0 >= $GIO_MIN_VERSION
                                  gio-unix-2.0 dbus-glib-1
-                                 gtk+-3.0 >= $GTK_MIN_VERSION
+                                 gtk+-2.0 >= $GTK_MIN_VERSION
                                  mutter-plugins >= $MUTTER_MIN_VERSION
                                  gjs-gi-1.0 >= $GJS_MIN_VERSION
 				 libgnome-menu $recorder_modules gconf-2.0
-                                 gdk-x11-3.0
+                                 gdk-x11-2.0
 				 clutter-x11-1.0 >= $CLUTTER_MIN_VERSION
 				 clutter-glx-1.0 >= $CLUTTER_MIN_VERSION
                                  libstartup-notification-1.0
@@ -12915,11 +12948,11 @@
         else
 	        MUTTER_PLUGIN_PKG_ERRORS=`$PKG_CONFIG --print-errors "gio-2.0 >= $GIO_MIN_VERSION
                                  gio-unix-2.0 dbus-glib-1
-                                 gtk+-3.0 >= $GTK_MIN_VERSION
+                                 gtk+-2.0 >= $GTK_MIN_VERSION
                                  mutter-plugins >= $MUTTER_MIN_VERSION
                                  gjs-gi-1.0 >= $GJS_MIN_VERSION
 				 libgnome-menu $recorder_modules gconf-2.0
-                                 gdk-x11-3.0
+                                 gdk-x11-2.0
 				 clutter-x11-1.0 >= $CLUTTER_MIN_VERSION
 				 clutter-glx-1.0 >= $CLUTTER_MIN_VERSION
                                  libstartup-notification-1.0
@@ -12930,11 +12963,11 @@
 
 	as_fn_error "Package requirements (gio-2.0 >= $GIO_MIN_VERSION
                                  gio-unix-2.0 dbus-glib-1
-                                 gtk+-3.0 >= $GTK_MIN_VERSION
+                                 gtk+-2.0 >= $GTK_MIN_VERSION
                                  mutter-plugins >= $MUTTER_MIN_VERSION
                                  gjs-gi-1.0 >= $GJS_MIN_VERSION
 				 libgnome-menu $recorder_modules gconf-2.0
-                                 gdk-x11-3.0
+                                 gdk-x11-2.0
 				 clutter-x11-1.0 >= $CLUTTER_MIN_VERSION
 				 clutter-glx-1.0 >= $CLUTTER_MIN_VERSION
                                  libstartup-notification-1.0
@@ -12947,9 +12980,10 @@
 
 Alternatively, you may set the environment variables MUTTER_PLUGIN_CFLAGS
 and MUTTER_PLUGIN_LIBS to avoid the need to call pkg-config.
-See the pkg-config man page for more details.
-" "$LINENO" 5
+See the pkg-config man page for more details." "$LINENO" 5
 elif test $pkg_failed = untried; then
+     	{ $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
+$as_echo "no" >&6; }
 	{ { $as_echo "$as_me:${as_lineno-$LINENO}: error: in \`$ac_pwd':" >&5
 $as_echo "$as_me: error: in \`$ac_pwd':" >&2;}
 as_fn_error "The pkg-config script could not be found or is too old.  Make sure it
@@ -12967,7 +13001,7 @@
 	MUTTER_PLUGIN_LIBS=$pkg_cv_MUTTER_PLUGIN_LIBS
         { $as_echo "$as_me:${as_lineno-$LINENO}: result: yes" >&5
 $as_echo "yes" >&6; }
-	:
+
 fi
 
 # This is for the newly added application id bits, we can replace this with
@@ -13031,6 +13065,8 @@
 
 
 if test $pkg_failed = yes; then
+   	{ $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
+$as_echo "no" >&6; }
 
 if $PKG_CONFIG --atleast-pkgconfig-version 0.20; then
         _pkg_short_errors_supported=yes
@@ -13054,9 +13090,10 @@
 
 Alternatively, you may set the environment variables TIDY_CFLAGS
 and TIDY_LIBS to avoid the need to call pkg-config.
-See the pkg-config man page for more details.
-" "$LINENO" 5
+See the pkg-config man page for more details." "$LINENO" 5
 elif test $pkg_failed = untried; then
+     	{ $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
+$as_echo "no" >&6; }
 	{ { $as_echo "$as_me:${as_lineno-$LINENO}: error: in \`$ac_pwd':" >&5
 $as_echo "$as_me: error: in \`$ac_pwd':" >&2;}
 as_fn_error "The pkg-config script could not be found or is too old.  Make sure it
@@ -13074,7 +13111,7 @@
 	TIDY_LIBS=$pkg_cv_TIDY_LIBS
         { $as_echo "$as_me:${as_lineno-$LINENO}: result: yes" >&5
 $as_echo "yes" >&6; }
-	:
+
 fi
 
 pkg_failed=no
@@ -13085,12 +13122,12 @@
     pkg_cv_ST_CFLAGS="$ST_CFLAGS"
  elif test -n "$PKG_CONFIG"; then
     if test -n "$PKG_CONFIG" && \
-    { { $as_echo "$as_me:${as_lineno-$LINENO}: \$PKG_CONFIG --exists --print-errors \"clutter-1.0 gtk+-3.0 libcroco-0.6 gnome-desktop-3.0 >= 2.90.0\""; } >&5
-  ($PKG_CONFIG --exists --print-errors "clutter-1.0 gtk+-3.0 libcroco-0.6 gnome-desktop-3.0 >= 2.90.0") 2>&5
+    { { $as_echo "$as_me:${as_lineno-$LINENO}: \$PKG_CONFIG --exists --print-errors \"clutter-1.0 gtk+-2.0 libcroco-0.6 gnome-desktop-2.0 >= 2.26\""; } >&5
+  ($PKG_CONFIG --exists --print-errors "clutter-1.0 gtk+-2.0 libcroco-0.6 gnome-desktop-2.0 >= 2.26") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
-  pkg_cv_ST_CFLAGS=`$PKG_CONFIG --cflags "clutter-1.0 gtk+-3.0 libcroco-0.6 gnome-desktop-3.0 >= 2.90.0" 2>/dev/null`
+  pkg_cv_ST_CFLAGS=`$PKG_CONFIG --cflags "clutter-1.0 gtk+-2.0 libcroco-0.6 gnome-desktop-2.0 >= 2.26" 2>/dev/null`
 else
   pkg_failed=yes
 fi
@@ -13101,12 +13138,12 @@
     pkg_cv_ST_LIBS="$ST_LIBS"
  elif test -n "$PKG_CONFIG"; then
     if test -n "$PKG_CONFIG" && \
-    { { $as_echo "$as_me:${as_lineno-$LINENO}: \$PKG_CONFIG --exists --print-errors \"clutter-1.0 gtk+-3.0 libcroco-0.6 gnome-desktop-3.0 >= 2.90.0\""; } >&5
-  ($PKG_CONFIG --exists --print-errors "clutter-1.0 gtk+-3.0 libcroco-0.6 gnome-desktop-3.0 >= 2.90.0") 2>&5
+    { { $as_echo "$as_me:${as_lineno-$LINENO}: \$PKG_CONFIG --exists --print-errors \"clutter-1.0 gtk+-2.0 libcroco-0.6 gnome-desktop-2.0 >= 2.26\""; } >&5
+  ($PKG_CONFIG --exists --print-errors "clutter-1.0 gtk+-2.0 libcroco-0.6 gnome-desktop-2.0 >= 2.26") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
-  pkg_cv_ST_LIBS=`$PKG_CONFIG --libs "clutter-1.0 gtk+-3.0 libcroco-0.6 gnome-desktop-3.0 >= 2.90.0" 2>/dev/null`
+  pkg_cv_ST_LIBS=`$PKG_CONFIG --libs "clutter-1.0 gtk+-2.0 libcroco-0.6 gnome-desktop-2.0 >= 2.26" 2>/dev/null`
 else
   pkg_failed=yes
 fi
@@ -13117,6 +13154,8 @@
 
 
 if test $pkg_failed = yes; then
+   	{ $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
+$as_echo "no" >&6; }
 
 if $PKG_CONFIG --atleast-pkgconfig-version 0.20; then
         _pkg_short_errors_supported=yes
@@ -13124,14 +13163,14 @@
         _pkg_short_errors_supported=no
 fi
         if test $_pkg_short_errors_supported = yes; then
-	        ST_PKG_ERRORS=`$PKG_CONFIG --short-errors --print-errors "clutter-1.0 gtk+-3.0 libcroco-0.6 gnome-desktop-3.0 >= 2.90.0" 2>&1`
+	        ST_PKG_ERRORS=`$PKG_CONFIG --short-errors --print-errors "clutter-1.0 gtk+-2.0 libcroco-0.6 gnome-desktop-2.0 >= 2.26" 2>&1`
         else
-	        ST_PKG_ERRORS=`$PKG_CONFIG --print-errors "clutter-1.0 gtk+-3.0 libcroco-0.6 gnome-desktop-3.0 >= 2.90.0" 2>&1`
+	        ST_PKG_ERRORS=`$PKG_CONFIG --print-errors "clutter-1.0 gtk+-2.0 libcroco-0.6 gnome-desktop-2.0 >= 2.26" 2>&1`
         fi
 	# Put the nasty error message in config.log where it belongs
 	echo "$ST_PKG_ERRORS" >&5
 
-	as_fn_error "Package requirements (clutter-1.0 gtk+-3.0 libcroco-0.6 gnome-desktop-3.0 >= 2.90.0) were not met:
+	as_fn_error "Package requirements (clutter-1.0 gtk+-2.0 libcroco-0.6 gnome-desktop-2.0 >= 2.26) were not met:
 
 $ST_PKG_ERRORS
 
@@ -13140,9 +13179,10 @@
 
 Alternatively, you may set the environment variables ST_CFLAGS
 and ST_LIBS to avoid the need to call pkg-config.
-See the pkg-config man page for more details.
-" "$LINENO" 5
+See the pkg-config man page for more details." "$LINENO" 5
 elif test $pkg_failed = untried; then
+     	{ $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
+$as_echo "no" >&6; }
 	{ { $as_echo "$as_me:${as_lineno-$LINENO}: error: in \`$ac_pwd':" >&5
 $as_echo "$as_me: error: in \`$ac_pwd':" >&2;}
 as_fn_error "The pkg-config script could not be found or is too old.  Make sure it
@@ -13160,7 +13200,7 @@
 	ST_LIBS=$pkg_cv_ST_LIBS
         { $as_echo "$as_me:${as_lineno-$LINENO}: result: yes" >&5
 $as_echo "yes" >&6; }
-	:
+
 fi
 
 pkg_failed=no
@@ -13171,12 +13211,12 @@
     pkg_cv_GDMUSER_CFLAGS="$GDMUSER_CFLAGS"
  elif test -n "$PKG_CONFIG"; then
     if test -n "$PKG_CONFIG" && \
-    { { $as_echo "$as_me:${as_lineno-$LINENO}: \$PKG_CONFIG --exists --print-errors \"dbus-glib-1 gtk+-3.0\""; } >&5
-  ($PKG_CONFIG --exists --print-errors "dbus-glib-1 gtk+-3.0") 2>&5
+    { { $as_echo "$as_me:${as_lineno-$LINENO}: \$PKG_CONFIG --exists --print-errors \"dbus-glib-1 gtk+-2.0\""; } >&5
+  ($PKG_CONFIG --exists --print-errors "dbus-glib-1 gtk+-2.0") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
-  pkg_cv_GDMUSER_CFLAGS=`$PKG_CONFIG --cflags "dbus-glib-1 gtk+-3.0" 2>/dev/null`
+  pkg_cv_GDMUSER_CFLAGS=`$PKG_CONFIG --cflags "dbus-glib-1 gtk+-2.0" 2>/dev/null`
 else
   pkg_failed=yes
 fi
@@ -13187,12 +13227,12 @@
     pkg_cv_GDMUSER_LIBS="$GDMUSER_LIBS"
  elif test -n "$PKG_CONFIG"; then
     if test -n "$PKG_CONFIG" && \
-    { { $as_echo "$as_me:${as_lineno-$LINENO}: \$PKG_CONFIG --exists --print-errors \"dbus-glib-1 gtk+-3.0\""; } >&5
-  ($PKG_CONFIG --exists --print-errors "dbus-glib-1 gtk+-3.0") 2>&5
+    { { $as_echo "$as_me:${as_lineno-$LINENO}: \$PKG_CONFIG --exists --print-errors \"dbus-glib-1 gtk+-2.0\""; } >&5
+  ($PKG_CONFIG --exists --print-errors "dbus-glib-1 gtk+-2.0") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
-  pkg_cv_GDMUSER_LIBS=`$PKG_CONFIG --libs "dbus-glib-1 gtk+-3.0" 2>/dev/null`
+  pkg_cv_GDMUSER_LIBS=`$PKG_CONFIG --libs "dbus-glib-1 gtk+-2.0" 2>/dev/null`
 else
   pkg_failed=yes
 fi
@@ -13203,6 +13243,8 @@
 
 
 if test $pkg_failed = yes; then
+   	{ $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
+$as_echo "no" >&6; }
 
 if $PKG_CONFIG --atleast-pkgconfig-version 0.20; then
         _pkg_short_errors_supported=yes
@@ -13210,14 +13252,14 @@
         _pkg_short_errors_supported=no
 fi
         if test $_pkg_short_errors_supported = yes; then
-	        GDMUSER_PKG_ERRORS=`$PKG_CONFIG --short-errors --print-errors "dbus-glib-1 gtk+-3.0" 2>&1`
+	        GDMUSER_PKG_ERRORS=`$PKG_CONFIG --short-errors --print-errors "dbus-glib-1 gtk+-2.0" 2>&1`
         else
-	        GDMUSER_PKG_ERRORS=`$PKG_CONFIG --print-errors "dbus-glib-1 gtk+-3.0" 2>&1`
+	        GDMUSER_PKG_ERRORS=`$PKG_CONFIG --print-errors "dbus-glib-1 gtk+-2.0" 2>&1`
         fi
 	# Put the nasty error message in config.log where it belongs
 	echo "$GDMUSER_PKG_ERRORS" >&5
 
-	as_fn_error "Package requirements (dbus-glib-1 gtk+-3.0) were not met:
+	as_fn_error "Package requirements (dbus-glib-1 gtk+-2.0) were not met:
 
 $GDMUSER_PKG_ERRORS
 
@@ -13226,9 +13268,10 @@
 
 Alternatively, you may set the environment variables GDMUSER_CFLAGS
 and GDMUSER_LIBS to avoid the need to call pkg-config.
-See the pkg-config man page for more details.
-" "$LINENO" 5
+See the pkg-config man page for more details." "$LINENO" 5
 elif test $pkg_failed = untried; then
+     	{ $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
+$as_echo "no" >&6; }
 	{ { $as_echo "$as_me:${as_lineno-$LINENO}: error: in \`$ac_pwd':" >&5
 $as_echo "$as_me: error: in \`$ac_pwd':" >&2;}
 as_fn_error "The pkg-config script could not be found or is too old.  Make sure it
@@ -13246,7 +13289,7 @@
 	GDMUSER_LIBS=$pkg_cv_GDMUSER_LIBS
         { $as_echo "$as_me:${as_lineno-$LINENO}: result: yes" >&5
 $as_echo "yes" >&6; }
-	:
+
 fi
 
 pkg_failed=no
@@ -13257,12 +13300,12 @@
     pkg_cv_TRAY_CFLAGS="$TRAY_CFLAGS"
  elif test -n "$PKG_CONFIG"; then
     if test -n "$PKG_CONFIG" && \
-    { { $as_echo "$as_me:${as_lineno-$LINENO}: \$PKG_CONFIG --exists --print-errors \"gtk+-3.0\""; } >&5
-  ($PKG_CONFIG --exists --print-errors "gtk+-3.0") 2>&5
+    { { $as_echo "$as_me:${as_lineno-$LINENO}: \$PKG_CONFIG --exists --print-errors \"gtk+-2.0\""; } >&5
+  ($PKG_CONFIG --exists --print-errors "gtk+-2.0") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
-  pkg_cv_TRAY_CFLAGS=`$PKG_CONFIG --cflags "gtk+-3.0" 2>/dev/null`
+  pkg_cv_TRAY_CFLAGS=`$PKG_CONFIG --cflags "gtk+-2.0" 2>/dev/null`
 else
   pkg_failed=yes
 fi
@@ -13273,12 +13316,12 @@
     pkg_cv_TRAY_LIBS="$TRAY_LIBS"
  elif test -n "$PKG_CONFIG"; then
     if test -n "$PKG_CONFIG" && \
-    { { $as_echo "$as_me:${as_lineno-$LINENO}: \$PKG_CONFIG --exists --print-errors \"gtk+-3.0\""; } >&5
-  ($PKG_CONFIG --exists --print-errors "gtk+-3.0") 2>&5
+    { { $as_echo "$as_me:${as_lineno-$LINENO}: \$PKG_CONFIG --exists --print-errors \"gtk+-2.0\""; } >&5
+  ($PKG_CONFIG --exists --print-errors "gtk+-2.0") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
-  pkg_cv_TRAY_LIBS=`$PKG_CONFIG --libs "gtk+-3.0" 2>/dev/null`
+  pkg_cv_TRAY_LIBS=`$PKG_CONFIG --libs "gtk+-2.0" 2>/dev/null`
 else
   pkg_failed=yes
 fi
@@ -13289,6 +13332,8 @@
 
 
 if test $pkg_failed = yes; then
+   	{ $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
+$as_echo "no" >&6; }
 
 if $PKG_CONFIG --atleast-pkgconfig-version 0.20; then
         _pkg_short_errors_supported=yes
@@ -13296,14 +13341,14 @@
         _pkg_short_errors_supported=no
 fi
         if test $_pkg_short_errors_supported = yes; then
-	        TRAY_PKG_ERRORS=`$PKG_CONFIG --short-errors --print-errors "gtk+-3.0" 2>&1`
+	        TRAY_PKG_ERRORS=`$PKG_CONFIG --short-errors --print-errors "gtk+-2.0" 2>&1`
         else
-	        TRAY_PKG_ERRORS=`$PKG_CONFIG --print-errors "gtk+-3.0" 2>&1`
+	        TRAY_PKG_ERRORS=`$PKG_CONFIG --print-errors "gtk+-2.0" 2>&1`
         fi
 	# Put the nasty error message in config.log where it belongs
 	echo "$TRAY_PKG_ERRORS" >&5
 
-	as_fn_error "Package requirements (gtk+-3.0) were not met:
+	as_fn_error "Package requirements (gtk+-2.0) were not met:
 
 $TRAY_PKG_ERRORS
 
@@ -13312,9 +13357,10 @@
 
 Alternatively, you may set the environment variables TRAY_CFLAGS
 and TRAY_LIBS to avoid the need to call pkg-config.
-See the pkg-config man page for more details.
-" "$LINENO" 5
+See the pkg-config man page for more details." "$LINENO" 5
 elif test $pkg_failed = untried; then
+     	{ $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
+$as_echo "no" >&6; }
 	{ { $as_echo "$as_me:${as_lineno-$LINENO}: error: in \`$ac_pwd':" >&5
 $as_echo "$as_me: error: in \`$ac_pwd':" >&2;}
 as_fn_error "The pkg-config script could not be found or is too old.  Make sure it
@@ -13332,7 +13378,7 @@
 	TRAY_LIBS=$pkg_cv_TRAY_LIBS
         { $as_echo "$as_me:${as_lineno-$LINENO}: result: yes" >&5
 $as_echo "yes" >&6; }
-	:
+
 fi
 
 MUTTER_BIN_DIR=`$PKG_CONFIG --variable=exec_prefix mutter-plugins`/bin
@@ -13418,6 +13464,10 @@
 
 
 
+
+
+
+
 if test "x$ac_cv_env_PKG_CONFIG_set" != "xset"; then
 	if test -n "$ac_tool_prefix"; then
   # Extract the first word of "${ac_tool_prefix}pkg-config", so it can be a program name with args.
@@ -13530,7 +13580,6 @@
 $as_echo "no" >&6; }
 		PKG_CONFIG=""
 	fi
-
 fi
 
   no_glib=""
@@ -13817,17 +13866,6 @@
 
 
 
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking if mutter was compiled with GTK+-3.0" >&5
-$as_echo_n "checking if mutter was compiled with GTK+-3.0... " >&6; }
-if $PKG_CONFIG --libs libmutter-private | grep gtk-x11-3 >/dev/null; then
-  { $as_echo "$as_me:${as_lineno-$LINENO}: result: yes" >&5
-$as_echo "yes" >&6; }
-else
-  { $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
-$as_echo "no" >&6; }
-  as_fn_error "GNOME Shell requires Mutter to be compiled against GTK+-3.0" "$LINENO" 5
-fi
-
 ac_config_files="$ac_config_files Makefile data/Makefile js/Makefile js/misc/Makefile js/ui/Makefile js/perf/Makefile js/prefs/Makefile src/Makefile tests/Makefile po/Makefile.in man/Makefile"
 
 cat >confcache <<\_ACEOF
Index: gnome-shell-2.31.5/configure.ac
===================================================================
--- gnome-shell-2.31.5.orig/configure.ac	2010-07-13 15:35:51.108606826 -0300
+++ gnome-shell-2.31.5/configure.ac	2010-07-13 15:43:45.680138740 -0300
@@ -61,17 +61,17 @@
 GOBJECT_INTROSPECTION_MIN_VERSION=0.6.11
 GJS_MIN_VERSION=0.7
 MUTTER_MIN_VERSION=2.31.4
-GTK_MIN_VERSION=2.90.4
+GTK_MIN_VERSION=2.21.1
 GIO_MIN_VERSION=2.25.9
 
 # Collect more than 20 libraries for a prize!
 PKG_CHECK_MODULES(MUTTER_PLUGIN, gio-2.0 >= $GIO_MIN_VERSION
                                  gio-unix-2.0 dbus-glib-1
-                                 gtk+-3.0 >= $GTK_MIN_VERSION
+                                 gtk+-2.0 >= $GTK_MIN_VERSION
                                  mutter-plugins >= $MUTTER_MIN_VERSION
                                  gjs-gi-1.0 >= $GJS_MIN_VERSION
 				 libgnome-menu $recorder_modules gconf-2.0
-                                 gdk-x11-3.0
+                                 gdk-x11-2.0
 				 clutter-x11-1.0 >= $CLUTTER_MIN_VERSION
 				 clutter-glx-1.0 >= $CLUTTER_MIN_VERSION
                                  libstartup-notification-1.0
@@ -88,9 +88,9 @@
 LIBS=$saved_LIBS
 
 PKG_CHECK_MODULES(TIDY, clutter-1.0)
-PKG_CHECK_MODULES(ST, clutter-1.0 gtk+-3.0 libcroco-0.6 gnome-desktop-3.0 >= 2.90.0)
-PKG_CHECK_MODULES(GDMUSER, dbus-glib-1 gtk+-3.0)
-PKG_CHECK_MODULES(TRAY, gtk+-3.0)
+PKG_CHECK_MODULES(ST, clutter-1.0 gtk+-2.0 libcroco-0.6 gnome-desktop-2.0 >= 2.26)
+PKG_CHECK_MODULES(GDMUSER, dbus-glib-1 gtk+-2.0)
+PKG_CHECK_MODULES(TRAY, gtk+-2.0)
 
 MUTTER_BIN_DIR=`$PKG_CONFIG --variable=exec_prefix mutter-plugins`/bin
 # FIXME: metacity-plugins.pc should point directly to its .gir file
@@ -154,14 +154,6 @@
 AC_PATH_PROG(mutter, [mutter])
 AC_SUBST(mutter)
 
-AC_MSG_CHECKING([if mutter was compiled with GTK+-3.0])
-if $PKG_CONFIG --libs libmutter-private | grep gtk-x11-3 >/dev/null; then
-  AC_MSG_RESULT(yes)
-else
-  AC_MSG_RESULT(no)
-  AC_MSG_ERROR([GNOME Shell requires Mutter to be compiled against GTK+-3.0])
-fi
-
 AC_CONFIG_FILES([
   Makefile
   data/Makefile
Index: gnome-shell-2.31.5/js/ui/environment.js
===================================================================
--- gnome-shell-2.31.5.orig/js/ui/environment.js	2010-07-13 15:35:51.120606119 -0300
+++ gnome-shell-2.31.5/js/ui/environment.js	2010-07-13 15:38:17.900108182 -0300
@@ -90,9 +90,9 @@
 
     _blockMethod('Clutter.Event.get_state', 'Shell.get_event_state',
                  'gjs\'s handling of Clutter.ModifierType is broken. See bug 597292.');
-    _blockMethod('Gdk.Display.get_device_state', 'global.get_pointer',
+    _blockMethod('Gdk.Display.get_pointer', 'global.get_pointer',
                  'gjs\'s handling of Gdk.ModifierType is broken. See bug 597292.');
-    _blockMethod('Gdk.Window.get_device_position', 'global.get_pointer',
+    _blockMethod('Gdk.Window.get_pointer', 'global.get_pointer',
                  'gjs\'s handling of Gdk.ModifierType is broken. See bug 597292.');
 
     // Now close the back door to prevent extensions from trying to
Index: gnome-shell-2.31.5/js/ui/main.js
===================================================================
--- gnome-shell-2.31.5.orig/js/ui/main.js	2010-07-13 15:35:51.140606593 -0300
+++ gnome-shell-2.31.5/js/ui/main.js	2010-07-13 15:38:17.900108182 -0300
@@ -2,9 +2,9 @@
 
 imports.gi.versions.Clutter = '1.0';
 imports.gi.versions.Gio = '2.0';
-imports.gi.versions.Gdk = '3.0';
+imports.gi.versions.Gdk = '2.0';
 imports.gi.versions.GdkPixbuf = '2.0';
-imports.gi.versions.Gtk = '3.0';
+imports.gi.versions.Gtk = '2.0';
 
 const Clutter = imports.gi.Clutter;
 const DBus = imports.dbus;
Index: gnome-shell-2.31.5/src/Makefile.am
===================================================================
--- gnome-shell-2.31.5.orig/src/Makefile.am	2010-07-13 15:35:51.152614686 -0300
+++ gnome-shell-2.31.5/src/Makefile.am	2010-07-13 15:38:17.900108182 -0300
@@ -232,7 +232,7 @@
 	        --namespace=St							\
 	        --nsversion=1.0							\
 	        --include=Clutter-1.0						\
-	        --include=Gtk-3.0						\
+	        --include=Gtk-2.0						\
 		--add-include-path=$(builddir)     				\
 	        --libtool="$(LIBTOOL)"						\
 	        --library=libst-1.0.la						\
Index: gnome-shell-2.31.5/src/Makefile.in
===================================================================
--- gnome-shell-2.31.5.orig/src/Makefile.in	2010-07-13 15:36:27.876606949 -0300
+++ gnome-shell-2.31.5/src/Makefile.in	2010-07-13 15:43:54.200106079 -0300
@@ -338,6 +338,8 @@
 PACKAGE_VERSION = @PACKAGE_VERSION@
 PATH_SEPARATOR = @PATH_SEPARATOR@
 PKG_CONFIG = @PKG_CONFIG@
+PKG_CONFIG_LIBDIR = @PKG_CONFIG_LIBDIR@
+PKG_CONFIG_PATH = @PKG_CONFIG_PATH@
 POFILES = @POFILES@
 POSUB = @POSUB@
 PO_IN_DATADIR_FALSE = @PO_IN_DATADIR_FALSE@
@@ -1924,7 +1926,7 @@
 	        --namespace=St							\
 	        --nsversion=1.0							\
 	        --include=Clutter-1.0						\
-	        --include=Gtk-3.0						\
+	        --include=Gtk-2.0						\
 		--add-include-path=$(builddir)     				\
 	        --libtool="$(LIBTOOL)"						\
 	        --library=libst-1.0.la						\
